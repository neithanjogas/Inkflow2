<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agendamento - Ink Flow Estúdio de Tatuagem</title>
    <meta name="description" content="Agende sua tatuagem no Ink Flow. Formulário online rápido e fácil. São Paulo, SP.">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <nav>
            <a href="index.html" class="logo">INK FLOW</a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="sobre.html">Sobre Nós</a></li>
                <li><a href="portfolio.html">Portfólio</a></li>
                <li><a href="servicos.html">Serviços</a></li>
                <li><a href="agendamento.html">Agendamento</a></li>
                <li><a href="contato.html">Contato</a></li>
                <li id="meus-agendamentos-link" style="display: none;"><a href="meus-agendamentos.html">Meus Agendamentos</a></li>
            </ul>
            <a href="login.html" style="color: var(--text-light); text-decoration: none; padding: 0.5rem 1rem; border: 1px solid var(--accent-red); border-radius: 4px; transition: all 0.3s ease;">Login</a>
        </nav>
    </header>

    <main>
        <section class="section">
            <h2>Agende sua Tatuagem</h2>
            <p style="text-align: center; color: var(--text-gray); margin-bottom: 3rem;">
                Preencha o formulário abaixo e entraremos em contato em até 24 horas
            </p>

            <div class="agendamento-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; align-items: start;">
                <div>
                    <form id="booking-form" style="background-color: var(--secondary-dark); padding: 2rem; border-radius: 10px;">
                        <div class="form-group">
                            <label for="name">Nome Completo *</label>
                            <input type="text" id="name" name="name" required>
                        </div>

                        <div class="form-group">
                            <label for="phone">Telefone/WhatsApp *</label>
                            <input type="tel" id="phone" name="phone" placeholder="(11) 99999-9999" required>
                        </div>

                        <div class="form-group">
                            <label for="age">Idade *</label>
                            <input type="number" id="age" name="age" min="18" max="100" required>
                        </div>

                        <div class="form-group">
                            <label for="service">Tipo de Serviço *</label>
                            <select id="service" name="service" required>
                                <option value="">Selecione um serviço</option>
                                <option value="tatuagem-artistica">Tatuagem Artística</option>
                                <option value="piercing">Piercing</option>
                                <option value="cover-up">Cover-up</option>
                                <option value="fine-line">Fine Line</option>
                                <option value="aquarela">Aquarela</option>
                                <option value="geometrica">Geométrica</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="artist">Artista Preferido</label>
                            <select id="artist" name="artist">
                                <option value="">Sem preferência</option>
                                <option value="marcus">Marcus Silva (Realismo)</option>
                                <option value="ana">Ana Costa (Aquarela/Fine Line)</option>
                                <option value="rafael">Rafael Santos (Geométrico)</option>
                                <option value="carla">Carla Mendes (Blackwork)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="size">Tamanho Aproximado</label>
                            <select id="size" name="size">
                                <option value="">Selecione o tamanho</option>
                                <option value="pequena">Pequena (até 5cm)</option>
                                <option value="media">Média (5-15cm)</option>
                                <option value="grande">Grande (15-30cm)</option>
                                <option value="muito-grande">Muito Grande (30cm+)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="location">Local do Corpo</label>
                            <input type="text" id="location" name="location" placeholder="Ex: braço, perna, costas...">
                        </div>

                        <div class="form-group">
                            <label for="description">Descrição da Ideia *</label>
                            <textarea id="description" name="description" rows="4" placeholder="Descreva sua ideia de tatuagem em detalhes..." required></textarea>
                        </div>

                        <div class="form-group">
                            <label for="budget">Orçamento Estimado</label>
                            <select id="budget" name="budget">
                                <option value="">Selecione uma faixa</option>
                                <option value="ate-300">Até R$ 300</option>
                                <option value="300-600">R$ 300 - R$ 600</option>
                                <option value="600-1000">R$ 600 - R$ 1.000</option>
                                <option value="1000-1500">R$ 1.000 - R$ 1.500</option>
                                <option value="acima-1500">Acima de R$ 1.500</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="availability">Disponibilidade *</label>
                            <textarea id="availability" name="availability" rows="3" placeholder="Informe seus dias e horários disponíveis..." required></textarea>
                        </div>

                        <div class="form-group">
                            <label for="first-tattoo">
                                <input type="checkbox" id="first-tattoo" name="first-tattoo" style="width: auto; margin-right: 0.5rem;">
                                Esta é minha primeira tatuagem
                            </label>
                        </div>

                        <div class="form-group">
                            <label for="terms">
                                <input type="checkbox" id="terms" name="terms" required style="width: auto; margin-right: 0.5rem;">
                                Concordo com os <a href="#" style="color: var(--accent-red);">termos e condições</a> *
                            </label>
                        </div>

                        <button type="submit" class="btn" style="width: 100%; font-size: 1.1rem;">
                            Enviar Solicitação
                        </button>
                    </form>
                </div>

                <div>
                    <div style="background-color: var(--secondary-dark); padding: 2rem; border-radius: 10px; margin-bottom: 2rem; border: 1px solid #333;">
                        <h3 style="color: var(--accent-red); margin-bottom: 1.5rem; font-size: 1.2rem; text-transform: uppercase; letter-spacing: 1px;">Políticas e Diretrizes</h3>
                        <ul style="color: var(--text-gray); line-height: 1.8; list-style: none; padding: 0;">
                            <li style="margin-bottom: 0.8rem; padding-left: 1rem; position: relative;">• Idade mínima obrigatória: 18 anos (documento com foto)</li>
                            <li style="margin-bottom: 0.8rem; padding-left: 1rem; position: relative;">• Consulta técnica inicial sem custo</li>
                            <li style="margin-bottom: 0.8rem; padding-left: 1rem; position: relative;">• Entrada de 50% do valor para confirmação</li>
                            <li style="margin-bottom: 0.8rem; padding-left: 1rem; position: relative;">• Retoque complementar gratuito até 30 dias</li>
                            <li style="margin-bottom: 0.8rem; padding-left: 1rem; position: relative;">• Reagendamento com 24h de antecedência mínima</li>
                        </ul>
                    </div>

                    <div style="background-color: var(--secondary-dark); padding: 2rem; border-radius: 10px; margin-bottom: 2rem; border: 1px solid #333;">
                        <h3 style="color: var(--accent-red); margin-bottom: 1.5rem; font-size: 1.2rem; text-transform: uppercase; letter-spacing: 1px;">Horário de Atendimento</h3>
                        <table style="width: 100%; color: var(--text-gray); border-collapse: collapse;">
                            <tr style="border-bottom: 1px solid #333;">
                                <td style="padding: 0.8rem 0; font-weight: 500; text-align: left;">Segunda a Sexta-feira</td>
                                <td style="padding: 0.8rem 0; text-align: right;">10:00 - 20:00</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #333;">
                                <td style="padding: 0.8rem 0; font-weight: 500; text-align: left;">Sábado</td>
                                <td style="padding: 0.8rem 0; text-align: right;">09:00 - 18:00</td>
                            </tr>
                            <tr>
                                <td style="padding: 0.8rem 0; font-weight: 500; text-align: left;">Domingo</td>
                                <td style="padding: 0.8rem 0; text-align: right;">10:00 - 16:00</td>
                            </tr>
                        </table>
                    </div>

                    <div style="background-color: var(--secondary-dark); padding: 2rem; border-radius: 10px;">
                        <h3 style="color: var(--accent-red); margin-bottom: 1rem;">💡 Dicas para seu Agendamento</h3>
                        <ul style="color: var(--text-gray); line-height: 1.8;">
                            <li>Traga referências visuais da sua ideia</li>
                            <li>Evite álcool 24h antes da sessão</li>
                            <li>Alimente-se bem antes de vir</li>
                            <li>Use roupas confortáveis</li>
                            <li>Traga documento com foto</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" style="text-align: center; background-color: var(--secondary-dark); margin: 0; padding: 4rem 2rem;">
            <h2>Precisa de ajuda?</h2>
            <p style="font-size: 1.1rem; margin-bottom: 2rem; color: var(--text-gray);">
                Nossa equipe está pronta para esclarecer suas dúvidas
            </p>
            <div style="display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
                <a href="https://wa.me/5511999999999" class="btn" target="_blank">
                    💬 WhatsApp
                </a>
                <a href="tel:+5511999999999" class="btn btn-outline">
                    📞 Ligar Agora
                </a>
                <a href="contato.html" class="btn btn-outline">
                    ✉️ E-mail
                </a>
            </div>
        </section>
    </main>

    <footer>
        <div class="social-links">
            <a href="https://instagram.com/inkflowsp" target="_blank" aria-label="Instagram">📷</a>
            <a href="https://tiktok.com/@inkflowsp" target="_blank" aria-label="TikTok">🎵</a>
            <a href="https://wa.me/5511999999999" target="_blank" aria-label="WhatsApp">💬</a>
        </div>
        <p>&copy; 2025 Ink Flow. Todos os direitos reservados.</p>
        <p>São Paulo, SP - Brasil</p>
    </footer>

    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/script.js"></script>
    <script>
        // Verificar se está logado - redirecionar se não estiver
        document.addEventListener('DOMContentLoaded', function() {
            if (window.authSystem && !window.authSystem.isLoggedIn()) {
                alert('Você precisa fazer login para acessar esta página.');
                window.location.href = 'login.html';
                return;
            }
        });
        
        // Manipular envio do formulário
        document.getElementById('booking-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const userData = window.authSystem.getCurrentUser();
            if (!userData) {
                alert('Erro: usuário não encontrado. Faça login novamente.');
                window.location.href = 'login.html';
                return;
            }
            
            const formData = new FormData(this);
            
            // Validação dos campos obrigatórios
            const requiredFields = ['name', 'phone', 'age', 'service', 'description', 'availability'];
            for (let field of requiredFields) {
                if (!formData.get(field) || formData.get(field).trim() === '') {
                    alert(`Por favor, preencha o campo: ${field}`);
                    return;
                }
            }
            
            // Validação da idade
            const age = parseInt(formData.get('age'));
            if (age < 18 || age > 100) {
                alert('Idade deve ser entre 18 e 100 anos.');
                return;
            }
            
            // Validação dos termos
            if (!formData.has('terms')) {
                alert('Você deve concordar com os termos e condições.');
                return;
            }
            
            const appointmentData = {
                id: Date.now(), // ID único
                userId: userData.id || userData.email, // Usar ID ou email como fallback
                name: formData.get('name').trim(),
                phone: formData.get('phone').trim(),
                age: age,
                service: formData.get('service'),
                artist: formData.get('artist') || 'Sem preferência',
                size: formData.get('size') || 'Não especificado',
                location: formData.get('location') || 'Não especificado',
                description: formData.get('description').trim(),
                budget: formData.get('budget') || 'Não especificado',
                availability: formData.get('availability').trim(),
                firstTattoo: formData.has('first-tattoo'),
                status: 'pendente',
                createdAt: new Date().toISOString()
            };
            
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Enviando...';
            submitBtn.disabled = true;
            
            try {
                // Tentar salvar via API primeiro
                await API.createAppointment(appointmentData);
                alert('Agendamento enviado com sucesso! Entraremos em contato em até 24 horas.');
                this.reset();
            } catch (error) {
                console.log('API não disponível, salvando localmente:', error);
                // Fallback para localStorage
                const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
                appointments.push(appointmentData);
                localStorage.setItem('appointments', JSON.stringify(appointments));
                alert('Agendamento salvo com sucesso! Entraremos em contato em até 24 horas.');
                this.reset();
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });
        
        // Atualizar navegação baseada no status de login
        if (window.authSystem) {
            window.authSystem.updateNavigation();
        }
    </script>
</body>
</html>