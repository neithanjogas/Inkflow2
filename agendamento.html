<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agendamento - Ink Flow Est√∫dio de Tatuagem</title>
    <meta name="description" content="Agende sua tatuagem no Ink Flow. Formul√°rio online r√°pido e f√°cil. S√£o Paulo, SP.">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <nav>
            <a href="index.html" class="logo">INK FLOW</a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="sobre.html">Sobre N√≥s</a></li>
                <li><a href="portfolio.html">Portf√≥lio</a></li>
                <li><a href="servicos.html">Servi√ßos</a></li>
                <li><a href="agendamento.html">Agendamento</a></li>
                <li><a href="contato.html">Contato</a></li>
                <li id="meus-agendamentos-link" style="display: none;"><a href="meus-agendamentos.html">Meus Agendamentos</a></li>
            </ul>
            <a href="login.html" style="color: var(--text-light); text-decoration: none; padding: 0.5rem 1rem; border: 1px solid var(--accent-red); border-radius: 4px; transition: all 0.3s ease;">Login</a>
        </nav>
    </header>

    <main>
        <section class="section">
            <h2>Agende sua Tatuagem</h2>
            <p style="text-align: center; color: var(--text-gray); margin-bottom: 3rem;">
                Preencha o formul√°rio abaixo e entraremos em contato em at√© 24 horas
            </p>

            <div class="agendamento-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; align-items: start;">
                <div>
                    <form id="booking-form" style="background-color: var(--secondary-dark); padding: 2rem; border-radius: 10px;">
                        <div class="form-group">
                            <label for="name">Nome Completo *</label>
                            <input type="text" id="name" name="name" required>
                        </div>

                        <div class="form-group">
                            <label for="phone">Telefone/WhatsApp *</label>
                            <input type="tel" id="phone" name="phone" placeholder="(11) 99999-9999" required>
                        </div>

                        <div class="form-group">
                            <label for="age">Idade *</label>
                            <input type="number" id="age" name="age" min="18" max="100" required>
                        </div>

                        <div class="form-group">
                            <label for="service">Tipo de Servi√ßo *</label>
                            <select id="service" name="service" required>
                                <option value="">Selecione um servi√ßo</option>
                                <option value="tatuagem-artistica">Tatuagem Art√≠stica</option>
                                <option value="piercing">Piercing</option>
                                <option value="cover-up">Cover-up</option>
                                <option value="fine-line">Fine Line</option>
                                <option value="aquarela">Aquarela</option>
                                <option value="geometrica">Geom√©trica</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="artist">Artista Preferido</label>
                            <select id="artist" name="artist">
                                <option value="">Sem prefer√™ncia</option>
                                <option value="marcus">Marcus Silva (Realismo)</option>
                                <option value="ana">Ana Costa (Aquarela/Fine Line)</option>
                                <option value="rafael">Rafael Santos (Geom√©trico)</option>
                                <option value="carla">Carla Mendes (Blackwork)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="size">Tamanho Aproximado</label>
                            <select id="size" name="size">
                                <option value="">Selecione o tamanho</option>
                                <option value="pequena">Pequena (at√© 5cm)</option>
                                <option value="media">M√©dia (5-15cm)</option>
                                <option value="grande">Grande (15-30cm)</option>
                                <option value="muito-grande">Muito Grande (30cm+)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="location">Local do Corpo</label>
                            <input type="text" id="location" name="location" placeholder="Ex: bra√ßo, perna, costas...">
                        </div>

                        <div class="form-group">
                            <label for="description">Descri√ß√£o da Ideia *</label>
                            <textarea id="description" name="description" rows="4" placeholder="Descreva sua ideia de tatuagem em detalhes..." required></textarea>
                        </div>

                        <div class="form-group">
                            <label for="budget">Or√ßamento Estimado</label>
                            <select id="budget" name="budget">
                                <option value="">Selecione uma faixa</option>
                                <option value="ate-300">At√© R$ 300</option>
                                <option value="300-600">R$ 300 - R$ 600</option>
                                <option value="600-1000">R$ 600 - R$ 1.000</option>
                                <option value="1000-1500">R$ 1.000 - R$ 1.500</option>
                                <option value="acima-1500">Acima de R$ 1.500</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="availability">Disponibilidade *</label>
                            <textarea id="availability" name="availability" rows="3" placeholder="Informe seus dias e hor√°rios dispon√≠veis..." required></textarea>
                        </div>

                        <div class="form-group">
                            <label for="first-tattoo">
                                <input type="checkbox" id="first-tattoo" name="first-tattoo" style="width: auto; margin-right: 0.5rem;">
                                Esta √© minha primeira tatuagem
                            </label>
                        </div>

                        <div class="form-group">
                            <label for="terms">
                                <input type="checkbox" id="terms" name="terms" required style="width: auto; margin-right: 0.5rem;">
                                Concordo com os <a href="#" style="color: var(--accent-red);">termos e condi√ß√µes</a> *
                            </label>
                        </div>

                        <button type="submit" class="btn" style="width: 100%; font-size: 1.1rem;">
                            Enviar Solicita√ß√£o
                        </button>
                    </form>
                </div>

                <div>
                    <div style="background-color: var(--secondary-dark); padding: 2rem; border-radius: 10px; margin-bottom: 2rem; border: 1px solid #333;">
                        <h3 style="color: var(--accent-red); margin-bottom: 1.5rem; font-size: 1.2rem; text-transform: uppercase; letter-spacing: 1px;">Pol√≠ticas e Diretrizes</h3>
                        <ul style="color: var(--text-gray); line-height: 1.8; list-style: none; padding: 0;">
                            <li style="margin-bottom: 0.8rem; padding-left: 1rem; position: relative;">‚Ä¢ Idade m√≠nima obrigat√≥ria: 18 anos (documento com foto)</li>
                            <li style="margin-bottom: 0.8rem; padding-left: 1rem; position: relative;">‚Ä¢ Consulta t√©cnica inicial sem custo</li>
                            <li style="margin-bottom: 0.8rem; padding-left: 1rem; position: relative;">‚Ä¢ Entrada de 50% do valor para confirma√ß√£o</li>
                            <li style="margin-bottom: 0.8rem; padding-left: 1rem; position: relative;">‚Ä¢ Retoque complementar gratuito at√© 30 dias</li>
                            <li style="margin-bottom: 0.8rem; padding-left: 1rem; position: relative;">‚Ä¢ Reagendamento com 24h de anteced√™ncia m√≠nima</li>
                        </ul>
                    </div>

                    <div style="background-color: var(--secondary-dark); padding: 2rem; border-radius: 10px; margin-bottom: 2rem; border: 1px solid #333;">
                        <h3 style="color: var(--accent-red); margin-bottom: 1.5rem; font-size: 1.2rem; text-transform: uppercase; letter-spacing: 1px;">Hor√°rio de Atendimento</h3>
                        <table style="width: 100%; color: var(--text-gray); border-collapse: collapse;">
                            <tr style="border-bottom: 1px solid #333;">
                                <td style="padding: 0.8rem 0; font-weight: 500; text-align: left;">Segunda a Sexta-feira</td>
                                <td style="padding: 0.8rem 0; text-align: right;">10:00 - 20:00</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #333;">
                                <td style="padding: 0.8rem 0; font-weight: 500; text-align: left;">S√°bado</td>
                                <td style="padding: 0.8rem 0; text-align: right;">09:00 - 18:00</td>
                            </tr>
                            <tr>
                                <td style="padding: 0.8rem 0; font-weight: 500; text-align: left;">Domingo</td>
                                <td style="padding: 0.8rem 0; text-align: right;">10:00 - 16:00</td>
                            </tr>
                        </table>
                    </div>

                    <div style="background-color: var(--secondary-dark); padding: 2rem; border-radius: 10px;">
                        <h3 style="color: var(--accent-red); margin-bottom: 1rem;">üí° Dicas para seu Agendamento</h3>
                        <ul style="color: var(--text-gray); line-height: 1.8;">
                            <li>Traga refer√™ncias visuais da sua ideia</li>
                            <li>Evite √°lcool 24h antes da sess√£o</li>
                            <li>Alimente-se bem antes de vir</li>
                            <li>Use roupas confort√°veis</li>
                            <li>Traga documento com foto</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" style="text-align: center; background-color: var(--secondary-dark); margin: 0; padding: 4rem 2rem;">
            <h2>Precisa de ajuda?</h2>
            <p style="font-size: 1.1rem; margin-bottom: 2rem; color: var(--text-gray);">
                Nossa equipe est√° pronta para esclarecer suas d√∫vidas
            </p>
            <div style="display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
                <a href="https://wa.me/5511999999999" class="btn" target="_blank">
                    üí¨ WhatsApp
                </a>
                <a href="tel:+5511999999999" class="btn btn-outline">
                    üìû Ligar Agora
                </a>
                <a href="contato.html" class="btn btn-outline">
                    ‚úâÔ∏è E-mail
                </a>
            </div>
        </section>
    </main>

    <footer>
        <div class="social-links">
            <a href="https://instagram.com/inkflowsp" target="_blank" aria-label="Instagram">üì∑</a>
            <a href="https://tiktok.com/@inkflowsp" target="_blank" aria-label="TikTok">üéµ</a>
            <a href="https://wa.me/5511999999999" target="_blank" aria-label="WhatsApp">üí¨</a>
        </div>
        <p>&copy; 2025 Ink Flow. Todos os direitos reservados.</p>
        <p>S√£o Paulo, SP - Brasil</p>
    </footer>

    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/script.js"></script>
    <script>
        // Verificar se est√° logado - redirecionar se n√£o estiver
        document.addEventListener('DOMContentLoaded', function() {
            if (window.authSystem && !window.authSystem.isLoggedIn()) {
                alert('Voc√™ precisa fazer login para acessar esta p√°gina.');
                window.location.href = 'login.html';
                return;
            }
        });
        
        // Manipular envio do formul√°rio
        document.getElementById('booking-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const userData = window.authSystem.getCurrentUser();
            if (!userData) {
                alert('Erro: usu√°rio n√£o encontrado. Fa√ßa login novamente.');
                window.location.href = 'login.html';
                return;
            }
            
            const formData = new FormData(this);
            
            // Valida√ß√£o dos campos obrigat√≥rios
            const requiredFields = ['name', 'phone', 'age', 'service', 'description', 'availability'];
            for (let field of requiredFields) {
                if (!formData.get(field) || formData.get(field).trim() === '') {
                    alert(`Por favor, preencha o campo: ${field}`);
                    return;
                }
            }
            
            // Valida√ß√£o da idade
            const age = parseInt(formData.get('age'));
            if (age < 18 || age > 100) {
                alert('Idade deve ser entre 18 e 100 anos.');
                return;
            }
            
            // Valida√ß√£o dos termos
            if (!formData.has('terms')) {
                alert('Voc√™ deve concordar com os termos e condi√ß√µes.');
                return;
            }
            
            const appointmentData = {
                id: Date.now(), // ID √∫nico
                userId: userData.id || userData.email, // Usar ID ou email como fallback
                name: formData.get('name').trim(),
                phone: formData.get('phone').trim(),
                age: age,
                service: formData.get('service'),
                artist: formData.get('artist') || 'Sem prefer√™ncia',
                size: formData.get('size') || 'N√£o especificado',
                location: formData.get('location') || 'N√£o especificado',
                description: formData.get('description').trim(),
                budget: formData.get('budget') || 'N√£o especificado',
                availability: formData.get('availability').trim(),
                firstTattoo: formData.has('first-tattoo'),
                status: 'pendente',
                createdAt: new Date().toISOString()
            };
            
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Enviando...';
            submitBtn.disabled = true;
            
            try {
                // Tentar salvar via API primeiro
                await API.createAppointment(appointmentData);
                alert('Agendamento enviado com sucesso! Entraremos em contato em at√© 24 horas.');
                this.reset();
            } catch (error) {
                console.log('API n√£o dispon√≠vel, salvando localmente:', error);
                // Fallback para localStorage
                const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
                appointments.push(appointmentData);
                localStorage.setItem('appointments', JSON.stringify(appointments));
                alert('Agendamento salvo com sucesso! Entraremos em contato em at√© 24 horas.');
                this.reset();
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });
        
        // Atualizar navega√ß√£o baseada no status de login
        if (window.authSystem) {
            window.authSystem.updateNavigation();
        }
    </script>
</body>
</html>